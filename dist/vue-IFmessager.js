!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VueIframeMessager=t():e.VueIframeMessager=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";n.r(t);var r=e=>({created(){this.$options[e]&&Object.keys(this.$options[e]).forEach(e=>{this.$vueIframeMessager.emitter.addListener(e,this.$options.messager[e],this)})},beforeDestroy(){this.$options[e]&&Object.keys(this.$options[e]).forEach(e=>{this.$vueIframeMessager.emitter.removeListener(e,this)})}});const i="\n当前role = 'parent'\n请传入options的iframeId\n",o=function(e){return void 0===e||""===e||"[object Object]"===Object.prototype.toString.call(e)&&0===Object.keys(e).length};var s=function(e,t){return o(e)||o(t)||o(t.window)?(console.error("\n参数错误： 请参考下方格式或文档\n\nVue.use(new VueIframeMessager({\n    role: 'iframe' || 'parent',  //必填\n    alias: '' //非必填\n    vuex: {\n        store,\n    },\n    options: {\n        iframeId: ''   \n        window: window,  //window对象,必填\n        origin: process.env.LOCAL_ORIGIN //vue-cli3中\n    }\n}))\n"),!1):!!~["parent","iframe"].indexOf(e)||(console.error('\nrole参数必填\n如果是iframe，则传入 "iframe"\n如果是父窗口，则传入 "parent"\n'),!1)};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}let f=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"parent"===t){if(o(n.iframeId))return console.error(i);this.trigger=()=>this.getIframeFromId(n.iframeId),this.receiver=n.window}"iframe"===t&&(this.trigger=n.window.parent,this.receiver=n.window),this.options=n}var t,n,r;return t=e,(n=[{key:"getIframeFromId",value:function(e){let t=document.getElementById(e);return t?t.contentWindow:console.error("\n当前options.iframeId不存在，请传入正确的id\n")}},{key:"send",value:function(e,t){("function"==typeof this.trigger?this.trigger():this.trigger).postMessage({type:`JSLQ-${e}`,data:t},this.options.origin)}}])&&a(t.prototype,n),r&&a(t,r),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}let l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.messager=t,this.emmiter=n,this.register()}var t,n,r;return t=e,(n=[{key:"register",value:function(){this.messager.receiver.addEventListener("message",e=>{const{data:t={}}=e;let{type:n="",data:r}=t;~n.indexOf("JSLQ")&&(n=n.split("-")[1],this.emmiter.emit(n,r))})}}])&&u(t.prototype,n),r&&u(t,r),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}let p=function(){function e(t={}){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t.store,this.actionPrefix=t.actionPrefix?t.actionPrefix:"MESSAGER_",this.mutationPrefix=t.mutationPrefix,this.listeners=new Map}var t,n,r;return t=e,(n=[{key:"addListener",value:function(e,t,n){"function"==typeof t?(this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push({callback:t,component:n})):console.error((e=>`\n    messager的属性${e}必须是function\n    `)(e))}},{key:"removeListener",value:function(e,t){if(this.listeners.has(e)){const n=this.listeners.get(e).filter(e=>e.component!==t);n.length>0?this.listeners.set(e,n):this.listeners.delete(e)}}},{key:"emit",value:function(e,t){this.listeners.has(e)&&this.listeners.get(e).forEach(e=>{e.callback.call(e.component,t)}),this.dispatchStore(e,t)}},{key:"dispatchStore",value:function(e,t){if(this.store&&this.store._actions){let n=this.actionPrefix+e;for(let e in this.store._actions){e.split("/").pop()===n&&this.store.dispatch(e,t)}if(this.mutationPrefix){let n=this.mutationPrefix+e;for(let e in this.store._mutations){e.split("/").pop()===n&&this.store.commit(e,t)}}}}}])&&c(t.prototype,n),r&&c(t,r),e}();function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"default",function(){return m});let m=function(){function e({role:t,alias:n="messager",vuex:r,options:i}){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(t,i)&&(this.alias=n,this[n]=new f(t,i),this.emitter=new p(r),this.listener=new l(this[n],this.emitter))}var t,n,i;return t=e,(n=[{key:"install",value:function(e){e.prototype["$"+this.alias]=this[this.alias],e.prototype.$vueIframeMessager=this,e.mixin(r(this.alias))}}])&&h(t.prototype,n),i&&h(t,i),e}()}]).default});